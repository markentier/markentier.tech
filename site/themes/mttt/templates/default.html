{% import "macros.html" as macros %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{% block title %}{{config.title}}{% endblock title %}</title>
  <base href="{{config.base_url | safe}}">

  {# update with content of final fonts.css #}
  <style>@font-face{font-family:'color-emoji';src:local("Apple Color Emoji"),local("Segoe UI Emoji"),local("Segoe UI Symbol"),local("Noto Color Emoji")}@font-face{font-family:'Varela Round';src:local("Varela Round"),local("Varela Round Regular"),local("VarelaRound-Regular"),url("/f/varela-round-regular.woff2") format("woff2");font-weight:normal;font-style:normal;font-display:swap}</style>
  {# disable external fonts.css when using inline style for them
    <link rel="preload" as="font" crossorigin="anonymous" href="/f/varela-round-regular.woff2"> -->
    <link rel="stylesheet" href="/fonts.css">
  #}

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/mtt.css">

  {% if page.extra.custom_delimiter %}
  <style>.article-body > p:first-of-type::after, hr::after { content: "{{page.extra.custom_delimiter}}";opacity: .25;}</style>
  {% endif %}

  {% if page.extra.custom_css %}
  <style>{{page.extra.custom_css | safe}}</style>
  {% endif %}

  <!-- https://medium.com/swlh/are-you-using-svg-favicons-yet-a-guide-for-modern-browsers-836a6aace3df -->
  <link rel="icon" href="/m.svg">
  <link rel="mask-icon" href="/m.svg" color="#063656">
  <link rel="apple-touch-icon" href="/m.180.png">
  <meta name="theme-color" content="#dfdddc">
  <link rel="manifest" href="/manifest.json">

  <meta name="description" content="{{config.description}}">
  {% if page.taxonomies.tags %}
  <meta name="keywords" content="{{page.taxonomies.tags | slice(end=10) | join(sep=",") }}">
  {% else %}
  <meta name="keywords" content="{{config.extra.keywords | join(sep=",") }}">
  {% endif %}

  <meta name="author" content="{{config.extra.author}} ({{config.extra.author_nick}})">
  <link rel="author" href="https://christoph.grabo.berlin/">
  <link rel="author" href="/humans.txt">
  <link rel="me" href="https://github.com/asaaki">

  {% if page %}
    {% set is_post = page.permalink is containing("/posts/") %}
    {% if is_post == true %}
      <link rel="canonical" href="{{page.permalink | safe}}">

      {% if page.extra.has_hero %}
        {% set page_image_url = macros::get_cover_image_url(url=page.permalink) %}
      {% else %}
        {% set page_image_url = macros::get_default_cover_image_url(base=config.base_url, img=config.extra.image_url) %}
      {% endif %}

      {% set page_image_alt = page.extra.image_alt | default(value=config.extra.image_alt) %}

      {% if page.description %}
        {% set page_description = page.description %}
      {% elif page.summary %}
        {% set page_description = page.summary %}
      {% else %}
        {% set page_description = page.content %}
      {% endif %}
      {% set page_description = page_description | striptags | split(pat=" ") | slice(end=31) | join(sep=" ") | safe %}

      <meta name="description" content="{{page_description}}">

      <meta name="twitter:card" content="summary_large_image">
      <meta name="twitter:url" content="{{page.permalink | safe}}">
      <meta name="twitter:title" content="{{page.title}}">
      <meta name="twitter:description" content="{{page_description}}">
      <meta name="twitter:creator" content="{{config.extra.author_nick}}">
      <meta name="twitter:site" content="{{config.extra.site_nick}}">
      <meta name="twitter:image" content="{{page_image_url | safe}}">
      <meta name="twitter:image:alt" content="{{page_image_alt}}">
      <meta name="twitter:label1" content="Written by" />
      <meta name="twitter:data1" content="{{config.extra.author}}" />
      <meta name="twitter:label2" content="Filed under" />
      <meta name="twitter:data2" content="{{page.taxonomies.categories | join(sep=', ')}}" />

      <meta property="og:type" content="article">
      <meta property="og:url" content="{{page.permalink | safe}}">
      <meta property="og:title" content="{{page.title}}">
      <meta property="og:description" content="{{page_description}}">
      <meta property="article:published_time" content="{{page.date | date(format="%FT%T%z")}}">
      <meta property="article:modified_time" content="{{page.date | date(format="%FT%T%z")}}">
      <meta property="og:image" content="{{page_image_url | safe}}">
      <meta property="og:site_name" content="{{config.title}}">
      <meta property="og:see_also" content="{{config.base_url | safe}}">
      <meta property="article:author" content="{{config.extra.author}}">

      {% if page.taxonomies.tags %}{% for tag in page.taxonomies.tags %}
        <meta property="article:tag" content="{{tag}}">
      {% endfor %}{% endif %}

      {% if page.taxonomies.categories %}{% for category in page.taxonomies.categories %}
        <meta property="article:section" content="{{category}}">
      {% endfor %}{{ macros::categories() }}{% endif %}

    {% else %}
      <meta name="description" content="{{config.description}}">
    {% endif %}
  {% endif %}

  <link rel="alternate" type="application/atom+xml" title="Atom Feed for {{config.title}}" href="/feed.atom.xml">
  <link rel="alternate" type="application/rss+xml" title="RSS Feed for {{config.title}}" href="/feed.rss.xml">
  <link rel="alternate" type="application/json" title="JSON Feed for {{config.title}}" href="/feed.json">

  {% block before_head_end %}{% endblock before_head_end %}
</head>
<body class="mtt">
  {% block after_body_open %}{% endblock after_body_open %}

  <div id="wrppr" class="wrppr">

    <header class="siteheader">{% block header %}
      <a href="/" rel="home" title="home" class="headlink">
        {# NOTE: ALWAYS KEEP IN SYNC WITH EXTERNAL FILE #}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" class="mtt-logo header-logo">
          <path class="logo-path" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="64" d="M480 506v208-128s0-72 64-72 64 72 64 72v128-128s0-72 64-72 64 72 64 72v128-128s0-72 64-72 64 72 64 72 1 85 1 128c-1 28-24 54-24 54-126 161-348 207-527 111-179-97-262-309-196-501 66-193 261-309 462-275 200 33 347 206 348 409" />
        </svg>
        <h1>{{config.title}}</h1>
      </a>
      <p class="site_description">{{config.description}}</p>
    {% endblock header %}</header>

    <nav class="navbar">
      <div class="navbar-menu">
        <a href="/">home</a>
        <a href="/resolution/">resolution</a>
        <a href="/about/">about</a>
      </div>
    </nav>

    <main id="content" class="content">
      {% block content_header %}{% endblock content_header %}
      {% block content %}{% endblock content %}
      {% block content_footer %}{% endblock content_footer %}
    </main>

    <footer class='footer'>{% block footer %}
     &copy; 2018â€”2020 markentier.tech / Christoph Grabo<br>
      <a href="/feed.atom.xml" rel="alternate" type="application/atom+xml" title="Atom Feed for {{config.title}}">atom</a>,
      <a href="/feed.rss.xml" rel="alternate" type="application/rss+xml" title="RSS Feed for {{config.title}}">rss</a>,
      <a href="/feed.json" rel="alternate" type="application/json" title="JSON Feed for {{config.title}}">json</a> |
      <a href="/tags/" rel=noindex>tags</a> |
      <a target="_blank" href="https://status.markentier.tech/" rel="external noopener" title="Status page for {{config.title}} (provided by updown.io)">status</a> |
      <a target="_blank" href="https://github.com/markentier/markentier.tech" rel="external noopener" title="Source code for {{config.title}}">source</a> |
      <a target="_blank" href="https://securityheaders.io/?q=https://markentier.tech/" rel="external noopener" title="Security Headers check for {{config.title}} (schd.io/5SaU)">schd.io</a>,
      <a target="_blank" href="https://www.ssllabs.com/ssltest/analyze.html?d=markentier.tech" rel="external noopener" title="SSL/TLS check for {{config.title}}">ssltest</a>
    {% endblock footer %}</footer>

  </div>

  <script async src="/js/mtt.js"></script>

  {% if page and page.extra.additional_scripts %}
    {% for script_path in page.extra.additional_scripts %}
    <script async src="{{script_path | safe }}"></script>
    {% endfor %}
  {% endif %}

  {% block before_body_end %}{% endblock before_body_end %}

{# DEBUG (port=3000) #}
{% if config.base_url is containing(":3000") %}
<details>
  <summary>DEBUG</summary>
  <pre id="__tera_context">{{ __tera_context | escape | safe }}</pre>
</details>
{% endif %}

</body>
</html>
